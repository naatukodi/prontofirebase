<!-- src/app/valuation-inspection/inspection-view.component.html -->
<ng-container *ngIf="!loading && !error && inspection">

  <app-workflow-buttons
    [id]="valuationId"
    [vehicleNumber]="vehicleNumber"
    [applicantContact]="applicantContact"
    [valuationType]="valuationType ?? ''">
  </app-workflow-buttons>

  <!-- ── Top Action Buttons ──────────────────────────────────────────────── -->
  <fieldset>
    <div class="actions">
      <button *ngIf="canEditInspection()" mat-raised-button color="primary" (click)="onEdit()">
        Edit
      </button>
      <button *ngIf="canDeleteInspection()" mat-raised-button color="warn" (click)="onDelete()">
        Delete
      </button>
      <button mat-raised-button color="warn" (click)="onBack()">
        Back
      </button>
    </div>
  </fieldset>

  <!-- ── Inspection Info ─────────────────────────────────────────────────── -->
  <fieldset class="nested-group">
    <legend>Inspection Info</legend>
    <div class="grid">
      <mat-form-field appearance="outline" *ngIf="showField('vehicleInspectedBy')">
        <mat-label>Vehicle Inspected By</mat-label>
        <input matInput [value]="inspection.vehicleInspectedBy" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('inspectionDate')">
        <mat-label>Date of Inspection</mat-label>
        <input matInput [value]="inspection.dateOfInspection | date:'mediumDate'" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('inspectionLocation')">
        <mat-label>Inspection Location</mat-label>
        <input matInput [value]="inspection.inspectionLocation" readonly />
      </mat-form-field>
    </div>
  </fieldset>

  <!-- ── Basic Vehicle Checks ────────────────────────────────────────────── -->
  <fieldset class="nested-group">
    <legend>Basic Vehicle Checks</legend>
    <div class="grid">
      <mat-form-field appearance="outline" *ngIf="showField('vehicleMoved')">
        <mat-label>Vehicle Moved</mat-label>
        <input matInput [value]="inspection.vehicleMoved ? 'Yes' : 'No'" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('engineStarted')">
        <mat-label>Engine Started</mat-label>
        <input matInput [value]="inspection.engineStarted ? 'Yes' : 'No'" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('odometer')">
        <mat-label>Odometer (km)</mat-label>
        <input matInput [value]="inspection.odometer" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('vinPlate')">
        <mat-label>VIN Plate Present</mat-label>
        <input matInput [value]="inspection.vinPlate ? 'Yes' : 'No'" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('bodyType')">
        <mat-label>Body Type</mat-label>
        <input matInput [value]="inspection.bodyType" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('overallTyreCondition')">
        <mat-label>Overall Tyre Condition</mat-label>
        <input matInput [value]="inspection.overallTyreCondition" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('otherAccessoryFitment')">
        <mat-label>Other Accessories Fitted</mat-label>
        <input matInput [value]="inspection.otherAccessoryFitment ? 'Yes' : 'No'" readonly />
      </mat-form-field>
    </div>
  </fieldset>

  <!-- ── External Visual Checks ──────────────────────────────────────────── -->
  <fieldset class="nested-group">
    <legend>External Visual Checks</legend>
    <div class="grid">
      <mat-form-field appearance="outline" *ngIf="showField('windshieldGlass')">
        <mat-label>Windshield / Glass</mat-label>
        <input matInput [value]="inspection.windshieldGlass" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('roadWorthyCondition')">
        <mat-label>Road Worthy Condition</mat-label>
        <input matInput [value]="inspection.roadWorthyCondition ? 'OK' : 'Not OK'" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('engineCondition')">
        <mat-label>Engine Condition</mat-label>
        <input matInput [value]="inspection.engineCondition" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('suspensionSystem')">
        <mat-label>Suspension System</mat-label>
        <input matInput [value]="inspection.suspensionSystem" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('steeringAssy')">
        <mat-label>Steering Assembly</mat-label>
        <input matInput [value]="inspection.steeringAssy" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('steeringWheel')">
        <mat-label>Steering Wheel</mat-label>
        <input matInput [value]="inspection.steeringWheel" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('steeringColumn')">
        <mat-label>Steering Column</mat-label>
        <input matInput [value]="inspection.steeringColumn" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('steeringBox')">
        <mat-label>Steering Box</mat-label>
        <input matInput [value]="inspection.steeringBox" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('steeringLinkages')">
        <mat-label>Steering Linkages</mat-label>
        <input matInput [value]="inspection.steeringLinkages" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('fuelSystem')">
        <mat-label>Fuel System</mat-label>
        <input matInput [value]="inspection.fuelSystem" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('brakeSystem')">
        <mat-label>Brake System</mat-label>
        <input matInput [value]="inspection.brakeSystem" readonly />
      </mat-form-field>
    </div>
  </fieldset>

  <!-- ── Structural & Body Checks ────────────────────────────────────────── -->
  <fieldset class="nested-group">
    <legend>Structural & Body Checks</legend>
    <div class="grid">
      <mat-form-field appearance="outline" *ngIf="showField('chassisCondition')">
        <mat-label>Chassis Condition</mat-label>
        <input matInput [value]="inspection.chassisCondition" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('exteriorCondition')">
        <mat-label>Exterior Condition</mat-label>
        <input matInput [value]="inspection.exteriorCondition" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('interiorCondition')">
        <mat-label>Interior Condition</mat-label>
        <input matInput [value]="inspection.interiorCondition" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('bonnet')">
        <mat-label>Bonnet</mat-label>
        <input matInput [value]="inspection.bonnet" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('bodyCondition')">
        <mat-label>Body Condition</mat-label>
        <input matInput [value]="inspection.bodyCondition" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('batteryCondition')">
        <mat-label>Battery Condition</mat-label>
        <input matInput [value]="inspection.batteryCondition" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('paintWork')">
        <mat-label>Paint Work</mat-label>
        <input matInput [value]="inspection.paintWork" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('audio')">
        <mat-label>Audio</mat-label>
        <input matInput [value]="inspection.audio" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('clutchSystem')">
        <mat-label>Clutch System</mat-label>
        <input matInput [value]="inspection.clutchSystem" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('gearboxAssembly')">
        <mat-label>Gearbox Assembly</mat-label>
        <input matInput [value]="inspection.gearBoxAssy" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('propellerShaft')">
        <mat-label>Propeller Shaft</mat-label>
        <input matInput [value]="inspection.propellerShaft" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('mudguards')">
        <mat-label>Mudguards</mat-label>
        <input matInput [value]="inspection.mudguards" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('allGlasses')">
        <mat-label>All Glasses</mat-label>
        <input matInput [value]="inspection.allGlasses" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('boom')">
        <mat-label>Boom</mat-label>
        <input matInput [value]="inspection.boom" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('bucket')">
        <mat-label>Bucket</mat-label>
        <input matInput [value]="inspection.bucket" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('chainTrack')">
        <mat-label>Chain Track</mat-label>
        <input matInput [value]="inspection.chainTrack" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('hydraulicCylinders')">
        <mat-label>Hydraulic Cylinders</mat-label>
        <input matInput [value]="inspection.hydraulicCylinders" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('swingUnit')">
        <mat-label>Swing Unit</mat-label>
        <input matInput [value]="inspection.swingUnit" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('differentialAssy')">
        <mat-label>Differential Assembly</mat-label>
        <input matInput [value]="inspection.differentialAssy" readonly />
      </mat-form-field>
    </div>
  </fieldset>

  <!-- ── Interior & Electrical Checks ────────────────────────────────────── -->
  <fieldset class="nested-group">
    <legend>Interior & Electrical Checks</legend>
    <div class="grid">
      <mat-form-field appearance="outline" *ngIf="showField('cabin')">
        <mat-label>Cabin Condition</mat-label>
        <input matInput [value]="inspection.cabin" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('dashboard')">
        <mat-label>Dashboard Condition</mat-label>
        <input matInput [value]="inspection.dashboard" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('seats')">
        <mat-label>Seats Condition</mat-label>
        <input matInput [value]="inspection.seats" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('upholestry')">
        <mat-label>Upholestry</mat-label>
        <input matInput [value]="inspection.upholestry" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('interiorTrims')">
        <mat-label>Interior Trims</mat-label>
        <input matInput [value]="inspection.interiorTrims" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('headLamps')">
        <mat-label>Head Lamps</mat-label>
        <input matInput [value]="inspection.headLamps" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('front')">
        <mat-label>Front View</mat-label>
        <input matInput [value]="inspection.front" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('rear')">
        <mat-label>Rear View</mat-label>
        <input matInput [value]="inspection.rear" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('axles')">
        <mat-label>Axles</mat-label>
        <input matInput [value]="inspection.axles" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('airConditioner')">
        <mat-label>Air Conditioner</mat-label>
        <input matInput [value]="inspection.airConditioner" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('electricAssembly')">
        <mat-label>Electric Assembly</mat-label>
        <input matInput [value]="inspection.electricAssembly" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('radiator')">
        <mat-label>Radiator</mat-label>
        <input matInput [value]="inspection.radiator" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('intercooler')">
        <mat-label>Intercooler</mat-label>
        <input matInput [value]="inspection.intercooler" readonly />
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="showField('allHosePipes')">
        <mat-label>All Hose & Pipes</mat-label>
        <input matInput [value]="inspection.allHosePipes" readonly />
      </mat-form-field>
    </div>
  </fieldset>

  <!-- ── Remarks Section ─────────────────────────────────────────────────── -->
  <fieldset class="nested-group">
    <legend>Remarks</legend>
    <div class="grid">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Remarks</mat-label>
        <textarea
          matInput
          [value]="inspection.remarks"
          readonly
          rows="3"
          placeholder="No remarks available">
        </textarea>
      </mat-form-field>
    </div>
  </fieldset>

  <!-- ── Photos & Images Section ─────────────────────────────────────────── -->
  <fieldset class="nested-group">
    <legend>Photos & Images</legend>
    <div class="actions">
      <button mat-raised-button color="primary" (click)="onClick()">
        View / Upload Images
      </button>
    </div>
  </fieldset>

  <!-- ✅ Common Notes Section (Inspection Notes) -->
  <fieldset class="nested-group">
    <legend>Inspection Notes</legend>
    <div class="notes-container">
      <app-common-notes
        [entityType]="'AVO'"
        [entityId]="valuationId"
        [currentUser]="getCurrentUser()"
        [collapsible]="true">
      </app-common-notes>
    </div>
  </fieldset>

  <!-- ── Bottom Action Buttons ────────────────────────────────────────────── -->
  <fieldset>
    <div class="actions">
      <button *ngIf="canEditInspection()" mat-raised-button color="primary" (click)="onEdit()">
        Edit
      </button>
      <button *ngIf="canDeleteInspection()" mat-raised-button color="warn" (click)="onDelete()">
        Delete
      </button>
      <button mat-raised-button color="warn" (click)="onBack()">
        Back
      </button>
    </div>
  </fieldset>

</ng-container>